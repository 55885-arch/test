<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Lesson Download</title>

<style>
body { margin:0; font-family: Arial, sans-serif; }
.container { display:flex; height:100vh; }
.sidebar { width:220px; background:#f3f3f3; padding:15px; overflow-y:auto; }
.menu-item { padding:8px; cursor:pointer; font-weight:bold; }
.menu-item:hover { background:#ddd; }
.dropdown { display:none; margin-left:15px; font-size:14px; }
.dropdown a { display:block; padding:5px; text-decoration:none; color:black; }
.dropdown a:hover { background:#ddd; }
.main { flex:1; padding:20px; }
.topbar { display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; }
.search { width:300px; padding:8px; }
.user-box { display:flex; align-items:center; gap:10px; }
.avatar { width:35px; height:35px; background:#333; color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; }
.logout { padding:6px 12px; cursor:pointer; }
.cards { display:grid; grid-template-columns:repeat(2,1fr); gap:25px; }
.card-link { text-decoration:none; color:black; }
.card { border:2px solid #000; padding:20px; cursor:pointer; transition:0.2s; }
.card:hover { background:#f5f5f5; transform:translateY(-2px); }
.pdf { margin-top:10px; font-size:14px; color:#555; }
</style>
</head>

<body>

<div class="container">

<!-- Sidebar -->
<div class="sidebar">

<a href="index.html" style="text-decoration:none; color:black;">
<div class="menu-item">Home</div>
</a>

<div class="menu-item" onclick="toggleDropdown('math')">
à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ â–¾
</div>
<div class="dropdown" id="math">
<a href="#" onclick="filterGrade('à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ','à¸¡.1')">à¸¡.1</a>
<a href="#" onclick="filterGrade('à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ','à¸¡.2')">à¸¡.2</a>
<a href="#" onclick="filterGrade('à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ','à¸¡.3')">à¸¡.3</a>
<a href="#" onclick="filterGrade('à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ','à¸¡.4')">à¸¡.4</a>
<a href="#" onclick="filterGrade('à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ','à¸¡.5')">à¸¡.5</a>
<a href="#" onclick="filterGrade('à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ','à¸¡.6')">à¸¡.6</a>
</div>

<div class="menu-item" onclick="toggleDropdown('science')">
à¸§à¸´à¸—à¸¢à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ â–¾
</div>
<div class="dropdown" id="science">
<a href="#" onclick="filterSubject('à¸§à¸´à¸—à¸¢à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œ')">à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”</a>
</div>

</div>

<!-- Main -->
<div class="main">

<div class="topbar">
<input class="search" id="search" type="text" placeholder="à¸„à¹‰à¸™à¸«à¸²à¸šà¸—à¹€à¸£à¸µà¸¢à¸™">
<div class="user-box">
<div class="avatar" id="avatar"></div>
<span id="usernameDisplay"></span>
<button class="logout" onclick="logout()">Logout</button>
</div>
</div>

<div class="cards" id="cardsContainer"></div>

</div>
</div>

<script>

// ðŸ”’ protect page
if (localStorage.getItem("loggedIn") !== "true") {
window.location.href = "login.html";
}

// ðŸ‘¤ show user
const username = localStorage.getItem("currentUser");
document.getElementById("usernameDisplay").innerText = username;
document.getElementById("avatar").innerText = username.charAt(0).toUpperCase();

function logout(){
localStorage.removeItem("loggedIn");
localStorage.removeItem("currentUser");
window.location.href="login.html";
}

// dropdown
function toggleDropdown(id){
const d=document.getElementById(id);
d.style.display = d.style.display==="block" ? "none":"block";
}

let allData=[];

// à¹‚à¸«à¸¥à¸” JSON
fetch("data.json")
.then(r=>r.json())
.then(data=>{
allData=data;
renderCards(data);
});

function renderCards(data){
const container=document.getElementById("cardsContainer");
container.innerHTML="";
data.forEach(c=>{
container.innerHTML+=`
<a class="card-link" data-search="${c.title} ${c.subject} ${c.grade}" href="${c.file}" target="_blank">
<div class="card">
<b>${c.subject}</b><br>
à¹€à¸£à¸·à¹ˆà¸­à¸‡ ${c.title}
<div class="pdf">${c.grade}</div>
</div>
</a>
`;
});
}

// filter à¸ˆà¸²à¸ sidebar
function filterGrade(subject,grade){
const filtered=allData.filter(c=>c.subject===subject && c.grade===grade);
renderCards(filtered);
}

function filterSubject(subject){
const filtered=allData.filter(c=>c.subject===subject);
renderCards(filtered);
}

// search
document.getElementById("search").addEventListener("keyup",function(){
const keyword=this.value.toLowerCase();
document.querySelectorAll(".card-link").forEach(card=>{
const text=card.dataset.search.toLowerCase();
card.style.display = text.includes(keyword) ? "block":"none";
});
});

</script>

</body>
</html>
